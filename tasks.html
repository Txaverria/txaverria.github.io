<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tasks</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

    <link rel="icon" type="image/x-icon" href="img/tasks/favicon.png" />

    <style>
      body {
        background-color: #1e1e2e;
        color: #c6d0f5;
        font-family: "Arimo", sans-serif;
        margin-left: 30%;
        margin-right: 30%;
      }
      h1 {
        margin: 20px 0;
      }

      .tasks-container {
        font-size: 1.5rem;
      }

      .task {
        display: flex;
        align-items: center;
        margin-bottom: px;
        font-size: 1.5rem;
        position: relative; /* Ensure the trash icon is positioned relative to the task */
        text-transform: lowercase;
      }

      .task input[type="checkbox"] {
        margin-right: 10px;
      }
      .task.completed {
        color: #f7e4f7;
        text-decoration: line-through;
      }
      .btn {
        background-color: #44475a;
        color: #c6d0f5;
        border: none;
      }
      .btn:hover {
        background-color: #f7e4f7;
        color: #44475a;
      }
      .trash-icon {
        cursor: pointer;
        margin-left: auto;
        color: #c6d0f5;
        visibility: hidden; /* Initially hidden */
        opacity: 0; /* Fully transparent */
      }

      .task:hover .trash-icon {
        visibility: visible; /* Visible when task is hovered */
        opacity: 1; /* Fully opaque */
      }

      .trash-icon:hover {
        color: #ff6b6b;
      }
      #editable-task {
        color: #c6d0f5;
        outline: none;
        border: none;
        background: none;
        font-family: inherit;
        font-size: inherit;
        padding: 5px;
        width: 100%;
        font-size: 1.5rem;
        text-transform: lowercase;
      }
      #editable-task::placeholder {
        color: #757575;
      }
      #editable-task:hover::placeholder {
        color: #f7e4f7;
      }

      input[type="checkbox"] {
        width: 0.7em;
        height: 0.7em;
      }
    </style>
  </head>
  <body>
    <h1 class="fw-bold">TASKS FOR TODAY</h1>

    <div id="tasks-container"></div>

    <input id="editable-task" type="text" placeholder="+ Type your task and press Enter" />

    <script>
      const tasksContainer = document.getElementById("tasks-container");
      const editableTask = document.getElementById("editable-task");

      // Load tasks from localStorage
      function loadTasks() {
        const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
        tasks.forEach((task) => {
          createTaskElement(task.text, task.completed);
        });
      }

      // Save tasks to localStorage
      function saveTasks() {
        const tasks = [];
        document.querySelectorAll(".task").forEach((taskDiv) => {
          const text = taskDiv.querySelector("span").textContent;
          const completed = taskDiv.querySelector("input[type='checkbox']").checked;
          tasks.push({ text, completed });
        });
        localStorage.setItem("tasks", JSON.stringify(tasks));
      }

      // Create task element
      function createTaskElement(taskText, isCompleted = false) {
        const taskDiv = document.createElement("div");
        taskDiv.className = "task";
        if (isCompleted) {
          taskDiv.classList.add("completed");
        }

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.checked = isCompleted;
        checkbox.addEventListener("change", () => {
          taskDiv.classList.toggle("completed", checkbox.checked);
          saveTasks();
        });

        const taskLabel = document.createElement("span");
        taskLabel.textContent = taskText;
        taskLabel.style.marginRight = "10px";

        const trashIcon = document.createElement("span");
        trashIcon.innerHTML = "<i class='bi bi-x-lg'></i>";
        trashIcon.className = "trash-icon";
        trashIcon.addEventListener("click", () => {
          tasksContainer.removeChild(taskDiv);
          saveTasks();
        });

        taskDiv.appendChild(checkbox);
        taskDiv.appendChild(taskLabel);
        taskDiv.appendChild(trashIcon);
        tasksContainer.appendChild(taskDiv);

        saveTasks();
      }

      // Handle task addition
      editableTask.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
          const taskText = editableTask.value.trim();
          if (taskText) {
            createTaskElement(taskText);
            editableTask.value = ""; // Clear input field
          }
        }
      });

      // Initialize tasks on page load
      loadTasks();
    </script>
  </body>
</html>
